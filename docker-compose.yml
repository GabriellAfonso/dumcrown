services:
  dum_django:
    container_name: dum_django
    image: dumcrown:latest
    user: "${UID}:${GID}"
    build:
      context: .
    ports:
      - 8000:8000
    volumes:
      - ./dumcrown:/dumcrown
      - ./dumcrown/dumcrown/static/dumcrown:/dumcrown/static/dumcrown
      - ./dumcrown/media:/dumcrown/media/
    env_file:
      - ./dotenv_files/.env
    depends_on:
      - dum_psql
      - dum_redis

  dum_redis:
    container_name: dum_redis
    restart: always
    image: redis:8.0
    volumes:
      - redisdata:/data
    ports:
      - 6379:6379
    command: [ "redis-server", "--save", "" ]

  dum_psql:
    container_name: dum_psql
    image: postgres:17-alpine
    ports:
      - 5433:5432
    volumes:
      - database:/var/lib/postgresql/data/
    env_file:
      - ./dotenv_files/.env

volumes:
  redisdata:
  database:
